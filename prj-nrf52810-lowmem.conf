# Low-memory configuration for nRF52810 (192KB FLASH)
# Minimal features to fit within device constraints
# Removes MCUmgr, reduces logging, disables optional subsystems

# ===== CORE SYSTEM =====
CONFIG_MAIN_STACK_SIZE=2048
CONFIG_HEAP_MEM_POOL_SIZE=4096

# ===== FLASH & STORAGE =====
# Disable MCUboot for low-memory variant (saves ~40KB)
CONFIG_BOOTLOADER_MCUBOOT=n
CONFIG_IMG_MANAGER=n

# ===== BLUETOOTH =====
CONFIG_BT=y
CONFIG_BT_PERIPHERAL=y
CONFIG_BT_CENTRAL=n
CONFIG_BT_SMP=n
CONFIG_BT_MAX_CONN=2
CONFIG_BT_L2CAP_TX_MTU=23
CONFIG_BT_BUF_EVT_RX_COUNT=2
CONFIG_BT_BUF_EVT_TX_COUNT=2
CONFIG_BT_RX_STACK_SIZE=1024

# Disable BLE features to save space
CONFIG_BT_GATT_CLIENT=n
CONFIG_BT_ISO=n
CONFIG_BT_EXT_ADV=n

# ===== LOGGING =====
# Minimal logging
CONFIG_LOG=y
CONFIG_LOG_MODE_IMMEDIATE=y
CONFIG_LOG_MAX_LEVEL=3
CONFIG_LOG_DEFAULT_LEVEL=2
CONFIG_LOG_STRDUP_BUF_COUNT=0
CONFIG_LOG_STRDUP_MAX_STRING=0

# ===== DRIVERS & PERIPHERALS =====
# I2C enabled for sensors
CONFIG_I2C=y
CONFIG_I2C_NRFX_TWIM=y
CONFIG_I2C_NRFX_TWIM_HOLD_ON_DISABLE=y

# GPIO enabled for basic I/O
CONFIG_GPIO=y

# ADC for battery monitoring (minimal)
CONFIG_ADC=y
CONFIG_ADC_NRFX_SAADC=y

# Watchdog
CONFIG_WATCHDOG=y

# Flash support
CONFIG_FLASH=y

# ===== DISABLE OPTIONAL FEATURES =====
# Disable unused subsystems
CONFIG_PM=n
CONFIG_DFU=n
CONFIG_UPDATEABLE_IMAGE_NUMBER=
CONFIG_MCUBOOT_UPDATE_FOOTER_SIZE=
CONFIG_RAM_POWER_DOWN_LIBRARY=n
CONFIG_RAM_POWER_ADJUST_ON_HEAP_RESIZE=n

# Disable MCUmgr (saves significant space)
CONFIG_MCUMGR=n
CONFIG_MCUMGR_SMP_BT=n
CONFIG_MCUMGR_CMD_IMG_MGMT=n
CONFIG_MCUMGR_CMD_OS_MGMT=n

# ===== OPTIMIZATION =====
# Size optimization
CONFIG_SIZE_OPTIMIZATIONS=y
CONFIG_COMPILER_OPT="-flto"

# Reduce string pool
CONFIG_CBPRINTF_COMPLETE=n
CONFIG_CBPRINTF_FULL=n

# ===== DRIVERS =====
# Only essential drivers
CONFIG_SERIAL=y
CONFIG_UART_CONSOLE=y
CONFIG_CONSOLE=y

# RTT console for debugging (optional, comment out to save more)
CONFIG_USE_SEGGER_RTT=y
CONFIG_SEGGER_RTT_CONSOLE=y

# ===== NEWLIB =====
CONFIG_NEWLIB_LIBC=y
CONFIG_NEWLIB_LIBC_NANO=y
